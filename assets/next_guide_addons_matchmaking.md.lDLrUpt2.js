import{_ as i,D as n,o as t,c as l,m as s,a,I as h,U as r}from"./chunks/framework.9RURDSnp.js";const v=JSON.parse('{"title":"Matchmaking","description":"","frontmatter":{},"headers":[],"relativePath":"next/guide/addons/matchmaking.md","filePath":"next/guide/addons/matchmaking.md"}'),p={name:"next/guide/addons/matchmaking.md"},o={id:"matchmaking",tabindex:"-1"},c=s("a",{class:"header-anchor",href:"#matchmaking","aria-label":'Permalink to "Matchmaking <Badge type="danger" text="alpha" />"'},"​",-1),d=r(`<p>Shulker Matchmaking is an addon for Shulker providing queuing capabilities to your <code>MinecraftServerFleets</code>. Players will be able to join <strong>matchmaking queues</strong>.</p><p>This addon makes use of <a href="https://open-match.dev/site/" target="_blank" rel="noreferrer">Open Match</a>, a match making system created by Google meant to be scalable and deeply configurable.</p><p>It will allow you to define <code>MatchmakingQueues</code> that associate a <code>MinecraftServerFleet</code> with a <strong>matchmaking function</strong> (an algorithm that groups queued players to form matches). While you&#39;ll be able to create your own match making algorithms to fit your needs, the addon provides basic algorithm sufficient for most use-cases:</p><ul><li>A <strong>Batch</strong> algorithm, to group players <em>as they go</em>, without distinction. This makes easy for you to create a queue and provision servers when they are needed</li><li>A <strong>Elo</strong> algorithm, which will group players depending on a <em>global score</em> that you&#39;ll have to define and implement</li></ul><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>The Elo algorithm is planned but is not available for now.</p></div><p>While manipulating Open Match directly to handle the queues is possible, Shulker Matchmaking makes it really easy by providing an SDK to be used in your plugins. After installing and scaling Open Match depending on your needs, you should forget about it.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This documentation will make use of the terms used by Open Match, it is advised for you to read the Open Match&#39;s documentation prior to the use of this addon:</p><p><a href="https://open-match.dev/site/docs/guides/matchmaker/" target="_blank" rel="noreferrer">https://open-match.dev/site/docs/guides/matchmaker/</a></p></div><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><p>Shulker Matchmaking requires <a href="https://open-match.dev/site/" target="_blank" rel="noreferrer">Open Match</a> to be installed on your Kubernetes cluster. You may need to tune its configuration to fit your needs, especially if you require high-availabiilty of your matchmaking system.</p><p>The addon can be enabled using the Helm chart, by toggling the <code>enabled</code> flag in the <code>values.yaml</code> file:</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">shulker-addon-matchmaking</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This will create two deployments:</p><ul><li>One named <code>director</code> that will read your <code>MatchmakingQueues</code>, poll Open Match for queued players at a fixed interval and finally will create and assign the servers</li><li>One named <code>mmf</code> <em>(for Match Making Function)</em> that exposes the built-in algorithms for you to use out-of-the-box</li></ul><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>While the first one cannot be scaled for now (this is a limitation that could be removed later on after a stabilization period), the <code>mmf</code> deployment <strong>can</strong> and <strong>should</strong> as it will be highly sollicitated if you have a large number of <code>MatchmakingQueues</code>. This is done by manipulating the Helm values.</p></div><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="creating-a-matchmakingqueue" tabindex="-1">Creating a <code>MatchmakingQueue</code> <a class="header-anchor" href="#creating-a-matchmakingqueue" aria-label="Permalink to &quot;Creating a \`MatchmakingQueue\`&quot;">​</a></h3><p>A <code>MatchmakingQueue</code> is a Kubernetes resource describing the shape of the matches to create. It associates a <code>MinecraftServerFleet</code> and a matchmaking function. It also specifies the size boundaries of the matches to create:</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">matchmaking.shulkermc.io/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MatchmakingQueue</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">free-for-all</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  targetFleetRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">free-for-all</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  mmf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    builtIn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Batch</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  minPlayers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  maxPlayers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>The previous manifests describes a <code>MatchmakingQueue</code> that:</p><ul><li>targets a <code>MinecraftServerFleet</code> named <code>free-for-all</code></li><li>groups the players using the built-in <code>Batch</code> algorithm</li><li>creates matches of 12 players at most</li><li>allows creation of partial matches for at least 8 players</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The <code>minPlayers</code> field is optional and can be ommited. When defined, the built-in matchmaking functions will allow the creation of <em>partial matches</em>, using the <strong>backfills</strong> machanism of Open Match (see Open Match&#39;s documentation for more information).</p><p>Otherwise, a <em>full match</em> will only be created when there are at lease <code>maxPlayers</code> players in the queue.</p></div><h3 id="creating-in-game-tickets" tabindex="-1">Creating in-game tickets <a class="header-anchor" href="#creating-in-game-tickets" aria-label="Permalink to &quot;Creating in-game tickets&quot;">​</a></h3><p>TODO.</p><h2 id="recipes" tabindex="-1">Recipes <a class="header-anchor" href="#recipes" aria-label="Permalink to &quot;Recipes&quot;">​</a></h2><h3 id="available-built-in-matchmaking-functions" tabindex="-1">Available built-in matchmaking functions <a class="header-anchor" href="#available-built-in-matchmaking-functions" aria-label="Permalink to &quot;Available built-in matchmaking functions&quot;">​</a></h3><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><strong>Batch</strong></td><td>Groups the players as they go, without any discriminator</td></tr><tr><td><strong>Elo</strong></td><td>Groups the players depending on an integer score and their waiting time in the queue</td></tr></tbody></table><h3 id="using-a-custom-matchmaking-function" tabindex="-1">Using a custom matchmaking function <a class="header-anchor" href="#using-a-custom-matchmaking-function" aria-label="Permalink to &quot;Using a custom matchmaking function&quot;">​</a></h3><p>You can create your own matchmaking function by exposing a gRPC server compliant with Open Match&#39;s specification. After deploying it in your Kubernetes cluster, you can refer to it in your <code>MatchmakingQueue</code>:</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">matchmaking.shulkermc.io/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MatchmakingQueue</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">free-for-all</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  targetFleetRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">free-for-all</span></span>
<span class="line has-focus"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  mmf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line has-focus"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    provided</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line has-focus"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">my-mmf</span></span>
<span class="line has-focus"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">9876</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div>`,29);function k(m,u,g,b,y,E){const e=n("Badge");return t(),l("div",null,[s("h1",o,[a("Matchmaking "),h(e,{type:"danger",text:"alpha"}),a(),c]),d])}const F=i(p,[["render",k]]);export{v as __pageData,F as default};
